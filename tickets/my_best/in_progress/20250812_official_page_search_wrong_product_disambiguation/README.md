---
file_type: "ticket_summary"
ticket_id: "TKT-20250812-001"
title: "公式ページ検索ノードが類似商品/別型番を取得する問題"
company: "マイベスト"
reporter: "Kano Sakuma"
create_date: "2025-08-12"
update_date: "2025-08-12"
deadline: ""
status: "保留"
category: "技術的問題"
priority: "中"
assigned_to: "未割り当て"
owner: "担当者未決定"
next_action: "先方環境での再検証結果待ち（返答待ち）"
ball_holder: "先方"
estimated_hours: "TBD"
issued_at: "2025-08-12"
due_date: ""
---

## サマリー
「★検証_紹介文（1段落目）生成」のワークフローにおいて、`公式ページ検索` ノードが類似商品や別型番、別カテゴリ（例: 施設/イベント名など）を誤って採用してしまう。特に商品名が一般名詞に近い場合や、百均系など公開情報が少ない商材で誤取得が発生。

## 影響範囲
- 生成される紹介文の事実誤り（ブランド/カテゴリ/型番の取り違え）
- 誤情報の公開リスク、編集工数の増加

## 想定原因
- 検索クエリにブランド/カテゴリ/型番等の拘束が弱い、`site:` 制約未活用
- 公式ドメイン優先ロジック/ドメイン許可リストの欠如
- 取得ページからの同一定義（Product Identity）抽出・検証が未実装
- 情報が少ない商材でランキングがノイズに引っ張られる（検索エンジン側スコアに依存）

## 初期対応方針（3層ディフェンス）
1) 検索段階: ブランド＋商品名（必要に応じて型番/カテゴリ）を引用符で厳密化、`site:公式ドメイン OR "公式"` を活用。既知の誤ヒット語を `-除外語` で抑制。
2) 抽出段階: 候補ページから `ブランド/商品名/型番/カテゴリ` を構造化抽出（JSON）。
3) 検証段階: LLM/ルールで同一性検証（ブランド一致、カテゴリ一致、型番一致が必須。非一致はrejectし次候補へフォールバック）。

## 次アクション
1. DSL内の `公式ページ検索` ノード設定を確認（クエリ、top_k、ドメイン制約、有効なフィルタ）。
2. 公式URL入力がある場合は最優先採用＋検証スキップ、無い場合のみ検索へ。
3. 「Product Identity 抽出」→「同一性バリデータ」ノードを組み込み、合格閾値（例: 0.85）未満は次候補へ。
4. テストセット（10〜20件）で再現ケースを含む評価を実施し、誤検率とカバー率を測定。


