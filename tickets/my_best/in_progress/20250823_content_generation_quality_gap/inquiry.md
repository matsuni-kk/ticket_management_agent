---
file_type: "inquiry"
ticket_id: "TKT-20250823-001"
company: "My Best"
reporter: "Minami Sasaki (経由: Amane Inoue)"
date: "2025-08-23"
status: "新規"
category: "技術的問題"
priority: "高"
issued_at: "2025-08-23"
due_date: ""
ball_holder: "当方"
---

# 商品コンテンツ自動生成：GAS×API vs 管理画面×APIの品質差異問題

## 顧客からの問い合わせ内容

### やりたいこと・背景
商品検証の結果・評価設計データを読み込み、商品コンテンツ（例）を生成すること。

**現状の問題**：
- 弊社管理画面での自動生成開発を進めていたが、アウトプットの質が良くない
- そのためDify活用の相談を受けた状態

### ご相談したいこと
**主要な問題**：
> （difyと直接関係ないのですが）gas×APIのアウトプットと管理画面×APIのアウトプットに大きく差があるとのことで、思い当たる原因などありますでしょうか・・・？

**追加相談事項**：
- 添付DSLのようなワークフローを作成している
- モデルやステップのアドバイスが欲しい
- 添付ファイル: `商品_自動生成コンテンツ.yml`

## 技術チームからの初期回答（Sasaki経由）

### 定例での初期アドバイス
**品質差異の原因分析**：
- スプレッドシートとシステムでアウトプットのクオリティが変わる件について
- **要確認事項**: 双方でプロンプト（入力値含めて）の構造が本当に一致しているか
- **推奨アクション**: APIのログを確認する

**考えられる原因**：
- systemプロンプトとuserプロンプトがちょっとずつ違う可能性
- 入力値の構造や形式の微細な差異

## まつにいさんからの対応状況

### 実施した修正内容
1. **プロンプト強化**の実施
2. **モデル変更**の実施

### 現在の課題・要修正事項
- **実際の入力値の把握不足**: 具体的な入力データが不明
- **未定義変数の存在**: ところどころ入力変数が未定義
- **画像関連の設定不安**: 画像部分の設定について確証が持てない状態

### 手動修正要請
顧客側での手動修正が必要な箇所があるため、修正後の検証が可能になる見込み。

## 技術的補足情報

### DifyのLLMノード設計ベストプラクティス
**System PromptとUser Promptの分離**：
- **System Prompt**: 普遍のルール
- **User Prompt**: 変数などの変動値

**効果**: LLMの出力が壊れづらくなる

## 提供資料
1. **商品_自動生成コンテンツ.yml**: Difyワークフロー設定ファイル
2. **image.png**: 設定画面のスクリーンショット（複数）

## 次のアクションが必要な事項
1. **APIログの詳細分析**: GAS×API vs 管理画面×APIの実際の差異特定
2. **プロンプト構造の完全一致確認**: 両環境での設定比較
3. **未定義変数の修正**: ワークフロー内の変数定義完了
4. **入力値の実データでの検証**: 実際のデータを使った動作確認
5. **画像関連設定の確認**: 画像処理部分の正確な設定

この問題解決により、商品コンテンツ自動生成の品質が両環境で統一され、My Bestの商品管理業務が大幅に効率化されることが期待されます。